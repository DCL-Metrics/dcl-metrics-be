result = Models::ParcelTraffic.
  where(coordinates: scene.coordinates.split(';')).
  select(:date, :addresses_json)

grouped = result.all.map(&:values).group_by { |x| "#{x[:date].year}-#{x[:date].month}" }
irb(main):051:1* grouped.sort.map do |month, data|
irb(main):052:1*   addresses = data.flat_map { |x| JSON.parse(x[:addresses_json]) }
irb(main):053:1*
irb(main):054:1*   [month, addresses.uniq.count, addresses.tally.count { |x,y| y > 1 }]
irb(main):055:0> end

# need to use strftime on date so it sorts right
[["2022-10", 1018, 317],
 ["2022-11", 545, 107],
 ["2022-12", 676, 295],
 ["2022-4", 688, 99],
 ["2022-5", 325, 38],
 ["2022-6", 643, 78],
 ["2022-7", 115, 5],
 ["2022-8", 374, 38],
 ["2022-9", 712, 231],
 ["2023-1", 130, 37],
 ["2023-10", 442, 349],
 ["2023-11", 477, 401],
 ["2023-12", 445, 368],
 ["2023-2", 90, 30],
 ["2023-3", 101, 24],
 ["2023-4", 30, 9],
 ["2023-5", 18, 3],
 ["2023-6", 18, 4],
 ["2023-7", 95, 40],
 ["2023-8", 147, 62],
 ["2023-9", 38, 15],
 ["2024-1", 350, 288]]

"2022-4", 688, 99
"2022-5", 325, 38
"2022-6", 643, 78
"2022-7", 115, 5
"2022-8", 374, 38
"2022-9", 712, 231
"2022-10", 1018, 317
"2022-11", 545, 107
"2022-12", 676, 295
"2023-1", 130, 37
"2023-2", 90, 30
"2023-3", 101, 24
"2023-4", 30, 9
"2023-5", 18, 3
"2023-6", 18, 4
"2023-7", 95, 40
"2023-8", 147, 62
"2023-9", 38, 15
"2023-10", 442, 349
"2023-11", 477, 401
"2023-12", 445, 368
"2024-1", 350, 288

